<div class="flex gap-3 items-center relative z-50">
  <div class="relative flex items-center">
    <button
      (click)="toggleDropdown()"
      class="relative w-8.5 h-8.5 rounded-full bg-[#D2F57F] overflow-hidden hover:bg-[#d4f580] transition group focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-[#D2F57F]"
    >
      <img
        src="/pages/workout-lists/notification.svg"
        alt="Notification"
        class="absolute w-5.5 h-5.5 bottom-1 left-1/2 -translate-x-1/2 opacity-80 group-hover:opacity-100"
      />
    </button>

    <div
      *ngIf="notifications.length > 0"
      class="absolute -top-1 -right-1 flex h-4.5 w-4.5 items-center justify-center rounded-full bg-red-500 border-2 border-white text-[9px] font-bold text-white shadow-sm pointer-events-none"
    >
      {{ notifications.length }}
    </div>

    <div
      *ngIf="isOpen"
      class="absolute md:right-10 right-0 mr-[-50px] top-8 mt-3 md:w-100 w-80 origin-top-right rounded-xl bg-white ring-1 ring-gray-300 ring-opacity-5 overflow-hidden z-50"
    >
      <div class="bg-gray-50 px-4 py-3 border-b border-gray-100 flex justify-between items-center">
        <span class="text-[18px] font-semibold text-gray-500">Notifications</span>
      </div>

      <ul class="max-h-[350px] overflow-y-auto overflow-x-hidden custom-scrollbar">
        <ng-container *ngFor="let item of notifications">
          <li class="relative overflow-hidden border-b border-gray-50 group select-none">
            <div
              class="absolute top-0 bottom-0 right-0 w-16 bg-gray-300 flex items-center justify-center z-0"
            >
              <button
                aria-label="delete"
                (click)="onDelete($event, item.id)"
                class="w-full h-full flex items-center justify-center text-white hover:bg-gray-400 transition"
              >
                <svg xmlns="" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M6 18L18 6M6 6l12 12"
                  />
                </svg>
              </button>
            </div>

            <div
              (click)="onSingleClick(item.id)"
              (dblclick)="onDoubleClick(item.link)"
              [class.-translate-x-16]="selectedId === item.id"
              [class.bg-[#faffec]]="selectedId === item.id"
              class="relative z-10 flex cursor-pointer gap-3 bg-white p-4 transition-transform duration-300 ease-in-out w-full hover:bg-gray-50"
            >
              <div
                [class]="
                  item.type === 'workout'
                    ? 'bg-blue-50 text-blue-600'
                    : 'bg-orange-50 text-orange-600'
                "
                class="flex h-10 w-10 shrink-0 items-center justify-center rounded-xl transition-transform duration-300"
              >
                <svg
                  *ngIf="item.type === 'workout'"
                  class="h-5 w-5"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M13 10V3L4 14h7v7l9-11h-7z"
                  />
                </svg>
                <svg
                  *ngIf="item.type === 'form'"
                  class="h-5 w-5"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                  />
                </svg>
              </div>

              <div class="flex-1 min-w-0 pr-2">
                <div class="flex justify-between items-start">
                  <p class="text-sm font-bold text-gray-800 truncate">{{ item.title }}</p>
                  <span class="text-[10px] text-gray-400 whitespace-nowrap ml-2">{{
                    item.time
                  }}</span>
                </div>
                <p class="text-xs text-gray-500 mt-1 line-clamp-2 leading-relaxed">
                  {{ item.message }}
                </p>
              </div>
            </div>
          </li>
        </ng-container>

        <li *ngIf="notifications.length === 0" class="py-10 text-center text-xs text-gray-400">
          No new notifications
        </li>
      </ul>
    </div>

    <div
      *ngIf="isOpen"
      (click)="toggleDropdown()"
      class="fixed inset-0 z-40 bg-transparent cursor-default"
    ></div>
  </div>

  <button
    routerLink="/profile/my-account"
    class="relative w-8.5 h-8.5 rounded-full bg-[#D2F57F] overflow-hidden hover:opacity-90 transition cursor-pointer focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-[#D2F57F]"
  >
    <img
      src="/pages/workout-lists/person.svg"
      alt="Profile"
      class="absolute w-7 h-7 bottom-0 left-1/2 -translate-x-1/2"
    />
  </button>
</div>
