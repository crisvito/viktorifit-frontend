<section class="hero-section">
  <h1 class="hero-title">HOW CAN WE HELP?</h1>

  <div class="search-container">
    <img src="/pages/support/search-icon.svg" alt="Search" class="search-icon" />
    <input
      type="text"
      placeholder="Search Question"
      class="search-input"
      (input)="searchFAQ($event)"
    />
    <button class="search-button">Search</button>
  </div>
</section>

<section class="faq-section">
  <h2 class="section-title">Frequently Asked Question</h2>

  <div class="faq-container">
    <div *ngIf="isLoading" class="text-center py-5">
      <p>Loading questions...</p>
    </div>
    <div
      *ngFor="let item of faqs; let i = index"
      class="faq-item"
      [class.active]="activeIndex === i"
    >
      <div class="faq-question" (click)="toggle(i)">
        <span>{{ item.question }}</span>
        <span class="faq-toggle" [class.active-icon]="activeIndex === i">+</span>
      </div>

      <div class="faq-answer">
        <p>{{ item.answer }}</p>
      </div>
    </div>
    <div *ngIf="!isLoading && faqs.length === 0" class="text-center py-10">
      <p class="text-gray-400">No FAQ found.</p>
    </div>
  </div>
</section>

<section class="contact-section">
  <div class="contact-card">
    <div class="contact-content">
      <div class="contact-info">
        <p class="help-text">We're here to help you!</p>
        <h2 class="discuss-title">
          LETS DISCUSS<br />
          <span class="text-white">Your Problem's<br />Solution Now!</span>
        </h2>
        <p class="contact-desc">
          Hello! If you still have any question or problem you can tell us here, or contact us to
          our social media. Thank you!
        </p>
        <div class="email-info">
          <img src="/pages/support/Inbox.svg" alt="Email" class="icon-img" />
          viktorifit@gmail.com
        </div>
      </div>

      <div class="contact-form">
        <div class="form-card">
          <form (ngSubmit)="submitForm(contactForm)" #contactForm="ngForm">
            <div class="form-group">
              <label for="name" class="input-label">Name</label>
              <div class="input-card">
                <input
                  type="text"
                  id="name"
                  placeholder="e.g John Green"
                  class="textbox-input"
                  [(ngModel)]="contactData.name"
                  name="name"
                  #nameInput="ngModel"
                  required
                />
              </div>
              <div
                class="error-message"
                *ngIf="nameInput.invalid && (nameInput.touched || contactForm.submitted)"
              >
                This field is required
              </div>
            </div>

            <div class="form-group">
              <label for="email" class="input-label">Email</label>
              <div class="input-card">
                <input
                  type="email"
                  id="email"
                  placeholder="e.g johngreen@gmail.com"
                  class="textbox-input"
                  [(ngModel)]="contactData.email"
                  name="email"
                  #emailInput="ngModel"
                  required
                  email
                />
              </div>
              <div
                class="error-message"
                *ngIf="emailInput.invalid && (emailInput.touched || contactForm.submitted)"
              >
                <span *ngIf="emailInput.errors?.['required']">This field is required</span>
                <span *ngIf="emailInput.errors?.['email']">Please enter a valid email address</span>
              </div>
            </div>

            <div class="form-group">
              <label for="description" class="input-label">Description</label>
              <div class="input-card">
                <textarea
                  id="description"
                  rows="4"
                  placeholder="Write your question or problem here..."
                  class="textbox-input"
                  [(ngModel)]="contactData.description"
                  name="description"
                  #descInput="ngModel"
                  required
                  maxlength="200"
                ></textarea>
              </div>
              <div class="flex flex-row-reverse justify-between items-center">
                <div class="char-count">{{ contactData.description.length }}/200</div>
                <div
                  class="error-message"
                  *ngIf="descInput.invalid && (descInput.touched || contactForm.submitted)"
                >
                  This field is required
                </div>
              </div>
            </div>

            <button type="submit" class="send-btn" [disabled]="isLoading">
              <span *ngIf="!isLoading" class="flex items-center gap-2">
                <img src="/pages/support/Send.svg" alt="Send" class="icon-img-btn" /> Send
              </span>
              <span *ngIf="isLoading">Sending...</span>
            </button>

            <div *ngIf="serverError" class="text-red-500 text-sm mt-2 text-center">
              {{ serverError }}
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</section>

<div
  *ngIf="showToast"
  class="fixed top-5 right-5 z-50 flex items-center w-full max-w-xs p-4 space-x-4 text-gray-500 bg-white rounded-lg shadow-lg border-l-4 border-green-500 animate-slide-in"
  role="alert"
>
  <div
    class="inline-flex items-center justify-center shrink-0 w-8 h-8 text-green-500 bg-green-100 rounded-lg"
  >
    <svg
      class="w-5 h-5"
      aria-hidden="true"
      xmlns="http://www.w3.org/2000/svg"
      fill="currentColor"
      viewBox="0 0 20 20"
    >
      <path
        d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z"
      />
    </svg>
  </div>
  <div class="pl-2 text-sm font-semibold text-gray-800">Message Sent Successfully!</div>
  <button
    (click)="closeToast()"
    type="button"
    class="ml-auto -mx-1.5 -my-1.5 bg-white text-gray-400 hover:text-gray-900 rounded-lg focus:ring-2 focus:ring-gray-300 p-1.5 hover:bg-gray-100 inline-flex items-center justify-center h-8 w-8"
  >
    <span class="sr-only">Close</span>
    <svg
      class="w-3 h-3"
      aria-hidden="true"
      xmlns="http://www.w3.org/2000/svg"
      fill="none"
      viewBox="0 0 14 14"
    >
      <path
        stroke="currentColor"
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"
      />
    </svg>
  </button>
</div>

<style>
  @keyframes slideIn {
    from {
      transform: translateX(100%);
      opacity: 0;
    }
    to {
      transform: translateX(0);
      opacity: 1;
    }
  }
  .animate-slide-in {
    animation: slideIn 0.3s ease-out forwards;
  }
</style>
